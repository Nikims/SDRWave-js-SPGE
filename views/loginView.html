<!doctype html>
<html>
  <head>
    <style>
      #cred-container {
        display: flex;
        background-color: rgb(78, 78, 78);
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 60vw;
        height: 100vh;
        z-index: 3;
      }

      .input-field {
        text-align: center;
        height: 20px;
        width: 63%;
        align-self: center;
      }

      .login-form {
        border-radius: 40px;
        font-family: Arial, Helvetica, sans-serif;
        position: relative;
        z-index: 4;
        color: aquamarine;
        text-align: center;
        background-color: rgb(39, 39, 39);
        line-height: 80%;
        margin-bottom: 14px;
        display: flex;
        flex-direction: column;
        width: 40vw;
        height: fit-content;
        overflow: hidden;
        transition: 0.3s;
        overflow: hidden;
      }

      .auth-button {
        font-size: large;
        height: 46px;
        width: 30%;
        align-self: center;
        margin-top: 25%;
        margin-top: 3%;
        margin-bottom: 5%;
      }

      .label {
        text-decoration: underline;
        font-weight: 700;
        font-size: large;
        font-family: Arial, Helvetica, sans-serif;
        color: aliceblue;
      }
    </style>
    <title>Login Page</title>
  </head>

  <body>
    <div id="cred-container">
      <form class="login-form">
        <br style="height: 40px" />
        <label class="label" for="usernameOrEmail">Username/Email:</label><br />
        <input
          class="input-field"
          type="text"
          id="usernameOrEmail"
          name="usernameOrEmail"
        /><br /><br />
        <label class="label" for="password">Password:</label><br />
        <input
          class="input-field"
          type="password"
          id="password"
          name="password"
        /><br /><br />
        <div
          style="
            display: flex;
            flex-direction: row; /* justify-items: right; */
            margin-inline-start: 28%;
          "
        >
          <button id="signinBtn" class="auth-button" type="submit">
            Login
          </button>
          <button id="signupBtn" class="auth-button" type="submit">
            Sign up
          </button>
        </div>
        <span id="response-msg"></span>
      </form>
    </div>
  </body>
  <script>
    document.querySelectorAll(".auth-button").forEach((btn) => {
      btn.addEventListener("click", async (event) => {
        event.preventDefault(); // Prevent form submission

        const usernameOrEmail =
          document.getElementById("usernameOrEmail").value;
        const password = document.getElementById("password").value;

        const data = {
          username: usernameOrEmail,
          password: password,
        };

        fetch(`/${btn.id.slice(0, -3)}`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        })
          .then((response) => response.json())
          .then((data) => {
            document.querySelector("#response-msg").innerText = data.error
              ? data.error
              : data.message;
            if (data.user) window.location.href = "/";
          })
          .catch((error) => {
            console.error(error);
            // Handle the error
          });
      });
    });
  </script>
</html>
